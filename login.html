<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inicio de Sesión</title>
<link rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.css" />
<style>
/* Estilos generales */
body {
  font-family: 'Arial', sans-serif;
  background-image: url('IMG_3101.jpeg');
  background-size: cover;
  background-position: center;
  color: #fff;
  margin: 0;
  padding: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

.auth-box {
  background-color: rgba(0, 0, 0, 0.7);
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
  width: 300px;
  text-align: center;
}

.auth-box h2 {
  margin-bottom: 20px;
  color: #fff;
}

.auth-box #firebaseui-auth-container {
  margin-bottom: 10px;
}

.auth-box #tos-container {
  margin-bottom: 10px;
}

.auth-box label {
  font-size: 14px;
  color: #fff;
}

.auth-box input[type="checkbox"] {
  margin-right: 5px;
}

.auth-box button {
  padding: 10px 20px;
  background-color: #ff6666;
  color: #fff;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  width: 100%;
}

.auth-box button:disabled {
  background-color: #ccc;
  cursor: not-allowed;
}

.modal {
  display: none;
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0, 0, 0, 0.4);
}

.modal-content {
  background-color: #fff;
  margin: 15% auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
  max-width: 400px;
  border-radius: 10px;
  text-align: center;
}

.close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}
</style>
</head>
<body>
<div class="auth-box">
  <h2 id="form-title">Iniciar Sesión</h2>
  <div id="firebaseui-auth-container"></div>
  
  <div id="tos-container">
    <label>
      <input type="checkbox" id="accept-tos" />
      Acepto los <a href="terms_of_service.html" target="_blank">Términos y Condiciones</a> y la <a href="privacy_policy.html" target="_blank">Política de Privacidad</a>
    </label>
  </div>
  
  <button id="login-button" disabled>Iniciar Sesión</button>
</div>

<div id="error-modal" class="modal">
  <div class="modal-content">
    <span class="close">×</span>
    <p id="error-message"></p>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.js"></script>
<script>
// Configuración de Firebase
const firebaseConfig = {
            apiKey: "AIzaSyBfGBf5Zmp1hEZHT9aKIhTRcXjULD-jbGw",
            authDomain: "mi-web-5402c.firebaseapp.com",
            databaseURL: "https://mi-web-5402c-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "mi-web-5402c",
            storageBucket: "mi-web-5402c.appspot.com",
            messagingSenderId: "31272724190",
            appId: "1:31272724190:web:51fcc8750c51abf783844f"
        };

// Inicializar Firebase
firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const ui = new firebaseui.auth.AuthUI(auth);

const uiConfig = {
  callbacks: {
    signInSuccessWithAuthResult: function(authResult, redirectUrl) {
      if (document.getElementById('accept-tos').checked) {
        return true;
      } else {
        showErrorModal('Debes aceptar los Términos y Condiciones para continuar.');
        return false;
      }
    },
    uiShown: function() {
      document.getElementById('loader').style.display = 'none';
    }
  },
  signInOptions: [
    firebase.auth.EmailAuthProvider.PROVIDER_ID,
    firebase.auth.GoogleAuthProvider.PROVIDER_ID
  ],
  tosUrl: 'terms_of_service.html',
  privacyPolicyUrl: 'privacy_policy.html'
};

ui.start('#firebaseui-auth-container', uiConfig);

// Habilitar el botón de inicio de sesión solo si se aceptan los términos
document.getElementById('accept-tos').addEventListener('change', function() {
  const loginButton = document.getElementById('login-button');
  loginButton.disabled = !this.checked;
});

// Mostrar modal de error
function showErrorModal(message) {
  const modal = document.getElementById('error-modal');
  const errorMessage = document.getElementById('error-message');
  errorMessage.textContent = message;
  modal.style.display = 'block';
}

// Cerrar modal de error
document.querySelector('.close').addEventListener('click', () => {
  document.getElementById('error-modal').style.display = 'none';
});

window.onclick = function(event) {
  const modal = document.getElementById('error-modal');
  if (event.target == modal) {
    modal.style.display = 'none';
  }
};
</script>
</body>
</html>
